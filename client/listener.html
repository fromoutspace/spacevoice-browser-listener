<!DOCTYPE html>
<head>
    <title>Speech recognition service</title>
    <meta charset="utf-8">
</head>
<body>
<h2 id="command"><i>Скажите что-нибудь...</i></h2>
<ul id="history"></ul>

<script src="speech.js"></script>
<script src="request-helper.js"></script>
<script src="ui-helper.js"></script>
<script>
    // Express server will replace this value
    let thisServerPort = '#serverPortToReplace';
    thisServerPort = isNaN(thisServerPort) ? '3000' : thisServerPort;

    const commandCallbackUrl = 'http://localhost:' + thisServerPort + "/command";

    const recognitionManager = new SpeechRecognitionManager();
    recognitionManager.start();
    recognitionManager.setOnResultCallback((results) => {
        ui.updateCommandAndHistory(results.join(', '));
        if (results.length) http.post(commandCallbackUrl, {command: results});
    });
</script>
</body>